<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>DropX ‚Äì Midnight Hoodie Drop</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#f4f6f8;
      --card:#ffffff;
      --text:#333;
      --muted:#6b7280;
      --brand:#111827;
      --ok:#10b981;
      --bad:#dc2626;
      --accent:#3b82f6;
      --border:#e5e7eb;
      --shadow:0 2px 12px rgba(0,0,0,.08);
      --radius:12px;
      --gap:18px;
      --container:1160px;
    }
    *{box-sizing:border-box}
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:var(--bg);
      color:var(--text);
      margin:0;
      padding:24px;
    }
    .container{
      max-width:var(--container);
      margin:auto;
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:28px;
      opacity:0;
      transform: translateY(8px);
      animation: fadeIn 500ms ease-out forwards;
    }
    @keyframes fadeIn{
      to{opacity:1; transform:none;}
    }
    header{
      display:flex; align-items:center; justify-content:space-between; gap:var(--gap); margin-bottom:22px;
    }
    .brand{font-weight:700;font-size:1.2rem}
    .muted{color:var(--muted)}
    h1{font-size:1.9rem;margin:.2rem 0 .6rem}
    .meta{font-size:.9rem;color:var(--muted)}

    /* product grid */
    .product-grid{
      display:grid; grid-template-columns: 360px 1fr; gap: var(--gap); align-items:start;
    }
    .gallery{
      display:grid; grid-template-columns: 1fr 1fr; gap: 10px;
      background:#fafafa; padding:10px; border-radius:10px; border:1px solid var(--border);
    }
    .gallery img{
      width:100%; aspect-ratio:1/1; object-fit:cover; border-radius:8px; border:1px solid #d1d5db;
      transition: transform 150ms ease;
    }
    .gallery img:hover{ transform: scale(1.02); }
    .details p{margin:.35rem 0}
    .badge{
      display:inline-block; background:var(--ok); color:#fff; padding:3px 10px; border-radius:999px; font-size:.85rem;
      transition: transform 120ms ease;
    }
    .badge.pulse{
      animation: pulse 700ms ease-in-out 2;
    }
    @keyframes pulse{
      0%{transform: scale(1)}
      50%{transform: scale(1.06)}
      100%{transform: scale(1)}
    }
    .ok{color:var(--ok)}
    .bad{color:var(--bad)}

    /* cards row */
    .cards{ display:grid; grid-template-columns: 1fr 380px; gap: var(--gap); margin-top:22px; }
    .card{
      background:var(--card); border:1px solid var(--border); border-radius:10px; padding:16px; box-shadow: var(--shadow);
    }
    .section-title{margin:.2rem 0 10px;font-size:1.1rem}

    .progress-outer{ background:#e5e7eb; height:12px; border-radius:8px; overflow:hidden; margin-top:6px }
    .progress-inner{
      width:0%; height:100%; background: linear-gradient(90deg, #60a5fa, #3b82f6);
      transition: width 300ms ease; /* smooth width animation */
    }
    .note{font-size:.85rem;color:var(--muted)}

    button{
      padding:10px 18px; background:var(--brand); color:#fff; border:0; border-radius:8px; cursor:pointer;
      transform: translateY(0); transition: transform 80ms ease, opacity 200ms ease, box-shadow 200ms ease;
      box-shadow: 0 1px 3px rgba(0,0,0,.12);
    }
    button:active{ transform: translateY(1px); }
    button[disabled]{
      opacity:.6; cursor:not-allowed; box-shadow:none;
    }
    .btn-soft{
      background:#374151;
    }

    /* event log */
    .log{ margin-top:20px }
    textarea{
      width:100%; height:160px; margin-top:8px; border-radius:8px; border:1px solid var(--border);
      padding:10px; font-family:ui-monospace, SFMono-Regular, Menlo, monospace; font-size:.9rem
    }

    /* responsive */
    @media (max-width: 1000px){ .cards{ grid-template-columns: 1fr } }
    @media (max-width: 820px){
      .product-grid{ grid-template-columns: 1fr }
      .gallery{ grid-template-columns: 1fr 1fr }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">DropX</div>
      <div class="muted">Limited Merch Drops</div>
    </header>

    <h1>üéØ Midnight Hoodie Drop</h1>
    <div class="meta">Generated: Aug 9, 2025 ‚Ä¢ Drop window: 4:07‚Äì4:16 AM</div>

    <!-- Product area -->
    <section class="product-grid">
      <div class="gallery">
        <img src="https://images.unsplash.com/photo-1622567893612-a5345baa5c9a?q=80&w=774&auto=format&fit=crop" alt="Front">
        <img src="https://images.unsplash.com/photo-1512400930990-e0bc0bd809df?q=80&w=1740&auto=format&fit=crop" alt="Detail">
      </div>

      <div class="details">
        <p><strong>Description:</strong> Limited edition heavyweight hoodie with embroidered chest logo.</p>
        <p><strong>Price:</strong> $79.99</p>
        <p><strong>Size:</strong>
          <select id="sizeSel">
            <option>S</option><option>M</option><option>L</option><option>XL</option>
            <option selected>2XL</option>
          </select>
        </p>
        <p><strong>Stock Available:</strong> <span class="badge" id="stockCount">17 left</span></p>
        <p class="note">CAPTCHA Status: <span id="captchaStatus" class="ok">‚úÖ Verified</span></p>
      </div>
    </section>

    <!-- Two-column cards: Queue & Security -->
    <section class="cards">
      <div class="card">
        <h3 class="section-title">‚è≥ Queue & Purchase</h3>
        <p><strong>Queue Position:</strong> <span id="qpos">47</span></p>
        <p><strong>Estimated Wait:</strong> <span id="qeta">‚Äì</span></p>
        <div class="progress-outer"><div class="progress-inner" id="qbar"></div></div>
        <p class="note" id="qnote">Preparing queue...</p>
        <div style="display:flex; gap:10px; margin-top:10px;">
          <button id="addToCart" disabled>Add to Cart</button>
          <button id="reset" class="btn-soft">Reset Demo</button>
        </div>
        <div id="purchaseMessage" style="margin-top:10px;color:var(--ok);display:none;">‚úÖ Purchase confirmed. Order ID: #12345</div>
        <div id="blockMessage" style="margin-top:10px;color:var(--bad);display:none;">‚ö†Ô∏è Suspicious activity detected. Challenge required and checkout blocked.</div>
      </div>

      <div class="card">
        <h3 class="section-title">üîê Security & Simulation</h3>
        <label><input type="checkbox" id="simulateBot"> Simulate bot user</label><br/>
        <label><input type="checkbox" id="simulateJitter"> Simulate network jitter</label>
        <p class="note">Identification and filtering are performed by Cloudflare bot management with queue fairness applied in the app layer.</p>
      </div>
    </section>

    <!-- Event log -->
    <section class="log">
      <h3 class="section-title">üìù Event Log</h3>
      <textarea id="eventLog" readonly></textarea>
    </section>

    <footer class="muted" style="text-align:center;margin-top:18px">
      ¬© 2025 DropX Inc. All rights reserved. ¬∑ Terms ¬∑ Privacy
    </footer>
  </div>

  <script>
    // Elements
    const simulateBot = document.getElementById('simulateBot');
    const simulateJitter = document.getElementById('simulateJitter');
    const captchaStatus = document.getElementById('captchaStatus');
    const purchaseMsg = document.getElementById('purchaseMessage');
    const blockMsg = document.getElementById('blockMessage');
    const addBtn = document.getElementById('addToCart');
    const resetBtn = document.getElementById('reset');
    const stockEl = document.getElementById('stockCount');
    const logEl = document.getElementById('eventLog');
    const qposEl = document.getElementById('qpos');
    const qetaEl = document.getElementById('qeta');
    const qbar = document.getElementById('qbar');
    const qnote = document.getElementById('qnote');

    // State
    let stock = 17;
    let queueTotal = 47;   // starting position
    let queueTime = 7000;  // ms to complete the queue animation
    let queueStart;

    function log(msg){
      const t = new Date().toLocaleTimeString();
      logEl.value += `[${t}] ${msg}\n`;
      logEl.scrollTop = logEl.scrollHeight;
    }

    function setCaptcha(verified){
      captchaStatus.textContent = verified ? '‚úÖ Verified' : '‚ùå Not Verified';
      captchaStatus.className = verified ? 'ok' : 'bad';
    }

    function enablePurchaseUI(){
      addBtn.disabled = false;
      addBtn.style.boxShadow = '0 4px 12px rgba(59,130,246,.35)';
      qnote.textContent = 'Queue complete. You may proceed.';
    }

    function animateQueue(){
      // reset UI
      addBtn.disabled = true;
      addBtn.style.boxShadow = 'none';
      qbar.style.width = '0%';
      qnote.textContent = 'Joining queue...';
      qetaEl.textContent = 'calculating...';
      qposEl.textContent = String(queueTotal);

      // start animation
      const start = performance.now();
      queueStart = start;
      const duration = queueTime;

      function step(now){
        const elapsed = now - start;
        const p = Math.min(elapsed / duration, 1); // 0..1
        const percent = Math.floor(p * 100);
        qbar.style.width = percent + '%';

        // position count down and eta
        const pos = Math.max(0, Math.ceil((1 - p) * queueTotal));
        qposEl.textContent = String(pos);
        const etaMs = Math.max(0, duration - elapsed);
        qetaEl.textContent = (etaMs/1000).toFixed(0) + ' seconds';

        if (p < 1){
          requestAnimationFrame(step);
        } else {
          qbar.style.width = '100%';
          qetaEl.textContent = '0 seconds';
          qnote.textContent = 'Finalizing gate checks...';
          setTimeout(() => {
            qnote.textContent = 'Queue complete. You may proceed.';
            enablePurchaseUI();
            log('Queue completed. User admitted.');
          }, 350);
        }
      }
      requestAnimationFrame(step);
      log('Queue animation started.');
    }

    function pulseStockBadge(){
      stockEl.classList.remove('pulse');
      void stockEl.offsetWidth; // restart animation
      stockEl.classList.add('pulse');
    }

    simulateBot.addEventListener('change', () => {
      setCaptcha(!simulateBot.checked);
      purchaseMsg.style.display = 'none';
      blockMsg.style.display = 'none';
      log(simulateBot.checked ? 'Bot simulation enabled.' : 'Bot simulation disabled.');
    });

    resetBtn.addEventListener('click', () => {
      stock = 17; stockEl.textContent = `${stock} left`;
      setCaptcha(true);
      purchaseMsg.style.display = 'none';
      blockMsg.style.display = 'none';
      queueTotal = 47;
      animateQueue();
      log('Demo reset.');
    });

    addBtn.addEventListener('click', () => {
      if (stock <= 0){ log('Stock depleted. Cannot add to cart.'); return; }

      const wait = simulateJitter.checked ? Math.floor(Math.random()*1000)+250 : 150;

      setTimeout(() => {
        if (simulateBot.checked){
          setCaptcha(false);
          purchaseMsg.style.display = 'none';
          blockMsg.style.display = 'block';
          log('Bot-like behavior flagged. Blocking checkout.');
        } else {
          stock--;
          stockEl.textContent = `${stock} left`;
          pulseStockBadge();
          purchaseMsg.style.display = 'block';
          blockMsg.style.display = 'none';
          log(`Add to Cart confirmed. Stock now ${stock}.`);
        }
      }, wait);
    });

    // kick things off
    setCaptcha(true);
    animateQueue();
    log('Demo initialized.');
  </script>
</body>
</html>
